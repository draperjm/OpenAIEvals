Title: Fixes issue #155 and #51
